# –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ–º–æ–∞–∫—Ü–∏–π

## –ü—Ä–æ–±–ª–µ–º–∞

–ü—Ä–∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –ø—Ä–æ–º–æ–∞–∫—Ü–∏–π –ø–æ–∫–∞–∑—ã–≤–∞–ª–æ—Å—å –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ –¥–ª—è –≤—Å–µ—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ (6—á, 12—á, 24—á):

```
üë• –£–ß–ê–°–¢–ù–ò–ö–ò:
   ‚Ä¢ –í—Å–µ–≥–æ: 14,450
   ‚Ä¢ –ó–∞ 6 —á: +790 (+6%)
   ‚Ä¢ –ó–∞ 12 —á: +790 (+6%)      ‚Üê –û–¥–∏–Ω–∞–∫–æ–≤—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
   ‚Ä¢ –ù–æ–≤—ã—Ö (16 —á.): +790 üìà   ‚Üê –≤–º–µ—Å—Ç–æ —Ä–∞–∑–Ω—ã—Ö
```

**–û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**
```
üë• –£–ß–ê–°–¢–ù–ò–ö–ò:
   ‚Ä¢ –í—Å–µ–≥–æ: 14,450
   ‚Ä¢ –ó–∞ 6 —á: +350 (+2%)       ‚Üê –ù–æ–≤—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 6 —á–∞—Å–æ–≤
   ‚Ä¢ –ó–∞ 12 —á: +500 (+3%)      ‚Üê –ù–æ–≤—ã—Ö –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 12 —á–∞—Å–æ–≤
   ‚Ä¢ –ù–æ–≤—ã—Ö (16 —á.): +790 üìà   ‚Üê –í—Å–µ–≥–æ –Ω–æ–≤—ã—Ö –∑–∞ 16 —á–∞—Å–æ–≤
```

## –ü—Ä–∏—á–∏–Ω–∞

–í —Ñ—É–Ω–∫—Ü–∏–∏ `get_participants_stats()` –≤ —Ñ–∞–π–ª–µ `services/participants_tracker_service.py` –±—ã–ª –Ω–µ–¥–æ—Å—Ç–∞—Ç–æ–∫ –ª–æ–≥–∏–∫–∏:

1. **–°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞:** –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ (6—á, 12—á, 24—á) –∏—Å–∫–∞–ª–∞—Å—å **–ª—é–±–∞—è** –∑–∞–ø–∏—Å—å, —Å–¥–µ–ª–∞–Ω–Ω–∞—è –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
2. **–ü—Ä–æ–±–ª–µ–º–∞:** –ï—Å–ª–∏ –∑–∞–ø–∏—Å–∏ –¥–µ–ª–∞—é—Ç—Å—è —Ä–µ–¥–∫–æ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑ –≤ 8 —á–∞—Å–æ–≤), —Ç–æ –¥–ª—è –≤—Å–µ—Ö –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–≤ –Ω–∞—Ö–æ–¥–∏–ª–∞—Å—å –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ —Å—Ç–∞—Ä–∞—è –∑–∞–ø–∏—Å—å
3. **–†–µ–∑—É–ª—å—Ç–∞—Ç:** –í—Å–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–æ–∫–∞–∑—ã–≤–∞–ª–∏ –æ–¥–∏–Ω–∞–∫–æ–≤—É—é —Ä–∞–∑–Ω–∏—Ü—É

### –ü—Ä–∏–º–µ—Ä –ø—Ä–æ–±–ª–µ–º–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è:

```
–°–µ–π—á–∞—Å 14:00 ‚Üí 14,450 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
8 —á–∞—Å–æ–≤ –Ω–∞–∑–∞–¥ (06:00) ‚Üí 13,660 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–ø–æ—Å–ª–µ–¥–Ω—è—è –∑–∞–ø–∏—Å—å –≤ –ë–î)

–ü—Ä–∏ –ø–æ–∏—Å–∫–µ:
- –î–ª—è 6—á –Ω–∞–∑–∞–¥ (08:00) ‚Üí –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –∑–∞–ø–∏—Å—å –æ—Ç 06:00 (13,660) ‚Üí diff = 790
- –î–ª—è 12—á –Ω–∞–∑–∞–¥ (02:00) ‚Üí —Ç–∞ –∂–µ –∑–∞–ø–∏—Å—å –æ—Ç 06:00 (13,660) ‚Üí diff = 790  
- –î–ª—è 24—á –Ω–∞–∑–∞–¥ (–≤—á–µ—Ä–∞) ‚Üí —Ç–∞ –∂–µ –∑–∞–ø–∏—Å—å –æ—Ç 06:00 (13,660) ‚Üí diff = 790
```

## –†–µ—à–µ–Ω–∏–µ

### 1. –£–ª—É—á—à–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–∏—Å–∫–∞ –∑–∞–ø–∏—Å–µ–π (participants_tracker_service.py)

```python
# –ò—â–µ–º –∑–∞–ø–∏—Å—å –≤ –æ–∫–Ω–µ ¬±2 —á–∞—Å–∞ –æ—Ç —Ü–µ–ª–µ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
time_window_start = time_ago - timedelta(hours=2)
time_window_end = time_ago + timedelta(hours=2)

record = db.query(PromoParticipantsHistory).filter(
    PromoParticipantsHistory.recorded_at >= time_window_start,
    PromoParticipantsHistory.recorded_at <= time_window_end
).first()

# –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏ - –±–µ—Ä–µ–º –±–ª–∏–∂–∞–π—à—É—é –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
if not record:
    record = db.query(...).filter(
        PromoParticipantsHistory.recorded_at <= time_ago
    ).first()
    
    # –ù–æ –µ—Å–ª–∏ –∑–∞–ø–∏—Å—å —Å–ª–∏—à–∫–æ–º —Å—Ç–∞—Ä–∞—è (–±–æ–ª–µ–µ 3—á –¥–æ —Ü–µ–ª–µ–≤–æ–≥–æ) - –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º
    if record and (time_ago - record.recorded_at) > timedelta(hours=3):
        record = None
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** 
- –ï—Å–ª–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –Ω–µ—Ç –ø–æ–¥—Ö–æ–¥—è—â–µ–π –∑–∞–ø–∏—Å–∏ –≤ –Ω—É–∂–Ω–æ–º –≤—Ä–µ–º–µ–Ω–Ω–æ–º –¥–∏–∞–ø–∞–∑–æ–Ω–µ, —ç—Ç–æ—Ç –∏–Ω—Ç–µ—Ä–≤–∞–ª –ø—Ä–æ—Å—Ç–æ –Ω–µ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è
- –≠—Ç–æ –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ —Ä–∞–∑–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –±—É–¥—É—Ç –∏–º–µ—Ç—å —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è

### 2. –£–ª—É—á—à–µ–Ω–æ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –≤ —Å–æ–æ–±—â–µ–Ω–∏—è—Ö (notification_service.py)

```python
# –°—Ç–∞—Ä–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - —Ç–æ–ª—å–∫–æ –¥–ª—è 6 —á–∞—Å–æ–≤
has_history = '6h' in participants_stats

# –ù–æ–≤–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ - –¥–ª—è –ª—é–±–æ–≥–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞
has_any_history = any(f'{h}h' in participants_stats for h in [6, 12, 24])

# –ü–æ–∫–∞–∑—ã–≤–∞–µ–º ALL –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã, –≤–∫–ª—é—á–∞—è —Ç–µ –≥–¥–µ diff = 0
for hours in [6, 12, 24]:
    if key in participants_stats:
        diff = stat.get('diff', 0)
        sign = '+' if diff > 0 else ''
        message += f"   ‚Ä¢ –ó–∞ {hours} —á: {sign}{diff:,} ({sign}{percent:.0f}%)\n"
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –£–±—Ä–∞–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ `if diff != 0` - —Ç–µ–ø–µ—Ä—å –ø–æ–∫–∞–∑—ã–≤–∞–µ–º –¥–∞–∂–µ –Ω—É–ª–µ–≤—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- ‚úÖ –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Ç–æ–ª—å–∫–æ —Ç–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã, –¥–ª—è –∫–æ—Ç–æ—Ä—ã—Ö –µ—Å—Ç—å –¥–∞–Ω–Ω—ã–µ
- ‚úÖ –ï—Å–ª–∏ –¥–ª—è –∏–Ω—Ç–µ—Ä–≤–∞–ª–∞ –Ω–µ—Ç –¥–∞–Ω–Ω—ã—Ö - –æ–Ω –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è

## –ò–∑–º–µ–Ω–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

1. **services/participants_tracker_service.py**
   - –§—É–Ω–∫—Ü–∏—è `get_participants_stats()` (—Å—Ç—Ä–æ–∫–∏ ~103-141)
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫–æ–Ω –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π

2. **bot/notification_service.py**
   - –§—É–Ω–∫—Ü–∏—è `format_promo_page()` (—Å—Ç—Ä–æ–∫–∏ ~1495-1514)
   - –§—É–Ω–∫—Ü–∏—è `format_gate_candy_page()` (—Å—Ç—Ä–æ–∫–∏ ~1800-1819)  
   - –§—É–Ω–∫—Ü–∏—è `format_weex_airdrop_page()` (—Å—Ç—Ä–æ–∫–∏ ~1958-1977)
   - –£–ª—É—á—à–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –¥–∞–Ω–Ω—ã—Ö –∏ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ü–æ—Å–ª–µ –≤–Ω–µ—Å–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π:

1. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å–∞ Python - –æ—à–∏–±–æ–∫ –Ω–µ—Ç
2. ‚è≥ –¢—Ä–µ–±—É–µ—Ç—Å—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ —Ä–∞–±–æ—Ç–µ:
   - –ü–æ–¥–æ–∂–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —á–∞—Å–æ–≤, —á—Ç–æ–±—ã –Ω–∞–∫–æ–ø–∏–ª–∏—Å—å –∑–∞–ø–∏—Å–∏ –≤ –ë–î
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —Ä–∞–∑–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è
   - –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –Ω–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –±–µ–∑ –¥–∞–Ω–Ω—ã—Ö

## –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–∏—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π –ø—Ä–æ–±–ª–µ–º–∞ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è, –≤–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–∏—á–∏–Ω—ã:

1. **–ó–∞–ø–∏—Å–∏ –¥–µ–ª–∞—é—Ç—Å—è —Å–ª–∏—à–∫–æ–º —Ä–µ–¥–∫–æ** - –Ω—É–∂–Ω–æ —É–≤–µ–ª–∏—á–∏—Ç—å —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø–∏—Å–∏ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –ë–î
2. **–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π** - –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω–µ —É–¥–∞–ª—è—é—Ç—Å—è –ª–∏ –∑–∞–ø–∏—Å–∏ —Å–ª–∏—à–∫–æ–º —Ä–∞–Ω–æ (–ø–∞—Ä–∞–º–µ—Ç—Ä `cleanup_old_records`)
3. **–ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –¥–∞–Ω–Ω—ã—Ö** - –¥–ª—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–π —Ä–∞–±–æ—Ç—ã –Ω—É–∂–Ω–æ –º–∏–Ω–∏–º—É–º 2-3 –∑–∞–ø–∏—Å–∏ –∑–∞ 24 —á–∞—Å–∞

## –î–∞—Ç–∞ –∏–∑–º–µ–Ω–µ–Ω–∏–π

16 —è–Ω–≤–∞—Ä—è 2026, 18:35 UTC
